---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
activity <- read.csv(file = "activity.csv", header = T, stringsAsFactors = F)
activity$date <-  as.Date(activity$date, format = "%Y-%m-%d")
```
## What is mean total number of steps taken per day?
```{r}
activity_no_na <- na.omit(activity)
total_steps_day <- aggregate(activity_no_na$steps, by=list(activity_no_na$date), FUN=sum)
hist(total_steps_day$x, xlab="Steps", ylab="Days", main = NA, col = "#7AC5CD", border = "white")
abline(v=mean(total_steps_day$x), lwd=3)
```

The mean total number of steps is `r round(mean(total_steps_day$x))`, showed in the histogram with a black vertical line, the median total number of steps is `r round(median(total_steps_day$x))`

## What is the average daily activity pattern?
```{r}
ts_steps <- aggregate(activity_no_na$steps, by=list(activity_no_na$interval), FUN=mean)
plot(ts_steps$Group.1, ts_steps$x, type = "l", 
     frame=F, lwd=2, xlab = "5-min interval", ylab = "Mean steps", xlim=c(0,2500))
max_step <- ts_steps[which(ts_steps$x == max(ts_steps$x)), ]
points(max_step, col="#EE3B3B", pch=8 )
```

## Imputing missing values
The 5-min intervals with steps values equal to NA will be replaced with the average number of steps for the same time interval.

```{r}
activity$imputed_steps <- activity$steps
for(i in seq_along(activity$interval)){
        if(is.na(activity$imputed_steps[i])){
                activity$imputed_steps[i] <- ts_steps[match(activity$interval[i], ts_steps$Group.1),2]
        }
}
total_steps_day_imp <- aggregate(activity$imputed_steps, by=list(activity$date), FUN=sum)
hist(total_steps_day_imp$x, xlab="Steps (imputed)", ylab="Number of days", main = NA, col = "#7AC5CD",  border = "white")
abline(v=mean(total_steps_day_imp$x), lwd=3)
```


## Are there differences in activity patterns between weekdays and weekends?

```{r}
activity$weekday <- weekdays(activity$date)
activity_WKND <- subset(activity, grepl("S(at|un)", activity$weekday))
activity_WEEK <- subset(activity, !grepl("S(at|un)", activity$weekday))
ts_steps_WEEK <- aggregate(activity_WEEK$imputed_steps, by=list(activity_WEEK$interval), FUN=mean)
ts_steps_WKND <- aggregate(activity_WKND$imputed_steps, by=list(activity_WKND$interval), FUN=mean)
par(mfrow=c(2,1))
plot(ts_steps_WEEK$Group.1, ts_steps_WEEK$x, type = "l", frame=F, lwd=2, xlab = "5-min interval", ylab = "Mean steps WEEK", ylim = c(0,210))
plot(ts_steps_WKND$Group.1, ts_steps_WKND$x, type = "l", frame=F, lwd=2, xlab = "5-min interval", ylab = "Mean steps WKND", ylim = c(0,210))

```


